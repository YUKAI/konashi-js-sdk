/*! konashi.js 2013-05-23 http://konashi.ux-xu.com */
!function(){var a={KONASHI_URL_SCHEME:"konashijs",HIGH:1,LOW:0,OUTPUT:1,INPUT:0,PULLUP:1,NO_PULLS:0,ENABLE:1,DISABLE:0,TRUE:1,FALSE:0,KONASHI_SUCCESS:0,KONASHI_FAILURE:-1,PIO0:0,PIO1:1,PIO2:2,PIO3:3,PIO4:4,PIO5:5,PIO6:6,PIO7:7,S1:0,LED2:1,LED3:2,LED4:3,LED5:4,AIO0:0,AIO1:1,AIO2:2,I2C_SDA:6,I2C_SCL:7,KONASHI_PWM_DISABLE:0,KONASHI_PWM_ENABLE:1,KONASHI_PWM_ENABLE_LED_MODE:2,KONASHI_PWM_LED_PERIOD:1e4,KONASHI_ANALOG_REFERENCE:1300,KONASHI_UART_RATE_2K4:10,KONASHI_UART_RATE_9K6:40,KONASHI_I2C_DATA_MAX_LENGTH:18,KONASHI_I2C_DISABLE:0,KONASHI_I2C_ENABLE:1,KONASHI_I2C_ENABLE_100K:1,KONASHI_I2C_ENABLE_400K:2,KONASHI_I2C_STOP_CONDITION:0,KONASHI_I2C_START_CONDITION:1,KONASHI_I2C_RESTART_CONDITION:2,KONASHI_UART_DATA_MAX_LENGTH:19,KONASHI_UART_DISABLE:0,KONASHI_UART_ENABLE:1,handlers:{},callbacks:{},messages:[],messageCount:0,on:function(a,b){this.handlers[a]||(this.handlers[a]=[]),this.handlers[a].push(b)},off:function(a,b){this.handlers[a]&&(b&&"function"==typeof b&&this.handlers[a][b]?delete this.handlers[a][b]:delete this.handlers[a])},trigger:function(a,b,c){var d=this.messageCount++,e=b||{},f=c||function(){};this.callbacks[d]=function(a){f(a),delete this.callbacks[d]},this.messages.push({eventName:a,messageId:d,data:e}),1==this.messages.length&&this.triggerToNative()},triggerToNative:function(){var a=this.messages[0].eventName,b=this.messages[0].messageId,c=this.messages[0].data,d=document.createElement("iframe");d.setAttribute("style","display:none"),d.setAttribute("height","0px"),d.setAttribute("width","0px"),d.setAttribute("frameborder","0"),document.documentElement.appendChild(d),d.src=this.KONASHI_URL_SCHEME+"://"+a+"/"+b+"?"+encodeURIComponent(JSON.stringify(c)),this.messages.shift()},log:function(a){var b=document.getElementById("konashi-debug-console");if(b){var c=document.createElement("p");c.innerHTML=a,b.firstChild?b.insertBefore(c,b.firstChild):b.appendChild(c)}},showDebugLog:function(){var a=document.createElement("div");a.setAttribute("style","position:fixed;left:0px;top:0px;z-index:100000;width:200px;height:100px;background-color:rgba(0,0,0,0.6);color:#FFF;font-size:11px;overflow:hidden;"),a.setAttribute("id","konashi-debug-console"),document.documentElement.appendChild(a)},hideDebugLog:function(){var a=document.getElementById("konashi-debug-console");a.parentNode.removeChild(a)},triggerFromNative:function(a,b){k.log("triggerFromNative eventname: "+a+", data: "+JSON.stringify(b));for(var c=this.handlers[a]||[],d=0;d<c.length;d++){var e=c[d];e&&"function"==typeof e&&setTimeout(function(){e(b)},0)}},triggerCallback:function(a,b){var c=this;k.log("triggerCallback id: "+a+", data: "+JSON.stringify(b)),setTimeout(function(){try{c.callbacks[Number(a)](b)}catch(d){}this.messages.length>0&&this.triggerToNative()},0)}};window.k=a}();